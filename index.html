<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CMYK Color Converter</title>
  <style>
    :root {
      --primary: #3366cc;
      --primary-light: #ccd9ff;
      --primary-dark: #1a3366;
      --text: #333333;
      --text-light: #666666;
      --background: #f5f7ff;
      --card-bg: #ffffff;
      --error: #cc3333;
      --success: #33cc66;
      --border-radius: 8px;
      --box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    .dark-mode {
      --primary: #4477dd;
      --primary-light: #224499;
      --primary-dark: #aabbee;
      --text: #f0f0f0;
      --text-light: #cccccc;
      --background: #222233;
      --card-bg: #333344;
      --border-radius: 8px;
      --box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: var(--background);
      color: var(--text);
      transition: var(--transition);
      padding: 30px;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 35px;
      flex-wrap: wrap;
    }
    
    h1 {
      color: var(--primary);
      margin: 0;
    }
    
    .top-toggles {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .dark-mode-container, .cmyk-mode-container {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 10px;
    }

    h3 {
      margin-bottom: 20px;
      margin-top: 10px;
    }

    .card {
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 25px;
      margin-bottom: 30px;
      transition: var(--transition);
    }

    .input-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .input-container {
      flex: 1;
      position: relative;
    }

    label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--text);
      font-size: 15px;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid var(--primary-light);
      border-radius: var(--border-radius);
      font-size: 16px;
      background-color: var(--card-bg);
      color: var(--text);
      transition: var(--transition);
      text-transform: uppercase;
    }

    input[type="text"]:focus {
      border-color: var(--primary);
      outline: none;
    }

    .error-message {
      color: var(--error);
      font-size: 12px;
      margin-top: 5px;
      min-height: 18px;
    }

    .color-picker-wrapper {
      position: relative;
      width: 50px;
      height: 50px;
      border-radius: var(--border-radius);
      overflow: hidden;
      border: 2px solid var(--primary-light);
      cursor: pointer;
    }

    .color-preview {
      width: 100%;
      height: 100%;
      background-color: #ffffff;
    }

    input[type="color"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 150%;
      height: 150%;
      opacity: 0;
      cursor: pointer;
    }

    .controls-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 25px;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    @media (max-width: 500px) {
      .controls-row {
        flex-direction: column;
        align-items: stretch;
      }
    }
    
    @media (max-width: 600px) {
      .header-container {
        flex-direction: column;
        align-items: center;
        gap: 15px;
      }
      
      .top-toggles {
        flex-direction: row;
        gap: 20px;
        margin-top: 10px;
      }
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: var(--border-radius);
      background-color: var(--primary);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      flex: 1;
      text-align: center;
      min-width: 120px;
    }

    .btn:hover {
      background-color: var(--primary-dark);
    }

    .btn:active {
      transform: translateY(1px);
    }

    .btn.btn-reset {
      background-color: var(--primary);
    }

    .btn.btn-reset:hover {
      background-color: var(--primary-dark);
    }

    .toggle-container {
      display: flex;
      align-items: center;
      gap: 15px;
      flex: 1;
      justify-content: center;
    }

    .toggle-label {
      font-weight: 600;
      color: var(--text);
      cursor: pointer;
      font-size: 15px;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--text-light);
      transition: var(--transition);
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: var(--transition);
      border-radius: 50%;
    }

    input:checked + .toggle-slider {
      background-color: var(--primary);
    }

    input:checked + .toggle-slider:before {
      transform: translateX(26px);
    }

    .preview-section {
      display: flex;
      gap: 30px;
      margin-bottom: 35px;
      flex-wrap: wrap;
    }

    .preview-box {
      flex: 1;
      min-width: 200px;
    }

    .color-box {
      height: 120px;
      border-radius: var(--border-radius);
      margin-bottom: 15px;
      border: 1px solid var(--text-light);
    }

    .color-data {
      font-size: 15px;
      color: var(--text);
      margin-bottom: 8px;
      line-height: 1.5;
    }

    .shade-section {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .shade-box {
      flex: 1;
      min-width: 120px;
    }

    .copy-btn {
      margin-top: 20px;
      width: 100%;
    }

    .copied-message {
      display: none;
      margin-left: 10px;
      color: var(--success);
    }

    .spectrum-container {
      margin-top: 30px;
    }

    .spectrum-label {
      margin-bottom: 10px;
      font-weight: 600;
    }

    .spectrum-bar {
      height: 30px;
      border-radius: var(--border-radius);
      position: relative;
      margin-bottom: 40px;
    }

    .spectrum-marker {
      position: absolute;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 3px rgba(0, 0, 0, 0.5);
      transform: translate(-50%, -50%);
      top: 50%;
      cursor: pointer;
      z-index: 1;
    }

    .marker-tooltip {
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      background-color: var(--primary);
      color: white;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s;
    }

    .spectrum-marker:hover .marker-tooltip {
      opacity: 1;
      visibility: visible;
    }

    .mode-toggle-container {
      margin: 20px 0;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }

    @media (max-width: 768px) {
      .preview-section {
        flex-direction: column;
      }

      .shade-section {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header-container">
      <h1>CMYK Color Converter</h1>
      <div class="top-toggles">
        <div class="dark-mode-container">
          <span class="toggle-label">Dark Mode</span>
          <label class="toggle-switch">
            <input type="checkbox" id="darkModeToggle">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="cmyk-mode-container">
          <span class="toggle-label">CMYK Mode</span>
          <label class="toggle-switch">
            <input type="checkbox" id="cmykModeToggle">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <div class="card input-section">
      <div class="input-group">
        <div class="color-picker-wrapper">
          <div id="colorPreview" class="color-preview"></div>
          <input type="color" id="colorPicker">
        </div>
        <div class="input-container">
          <label for="hexInput">HEX Color</label>
          <input type="text" id="hexInput" maxlength="6" placeholder="Enter 6-digit HEX (no #)" 
                 autocomplete="off" autocapitalize="characters">
          <div id="errorMessage" class="error-message"></div>
        </div>
      </div>
    </div>

    <div class="controls-row">
      <button id="resetBtn" class="btn btn-reset">Reset</button>
    </div>

    <div class="preview-section">
      <div class="preview-box card">
        <h3>Original Color</h3>
        <div id="originalColorBox" class="color-box"></div>
        <div id="originalHex" class="color-data">HEX: #000000</div>
        <div id="originalRgb" class="color-data">RGB: 0, 0, 0</div>
      </div>
      <div class="preview-box card">
        <h3>Simulated CMYK</h3>
        <div id="cmykColorBox" class="color-box"></div>
        <div id="cmykHex" class="color-data">HEX: #000000</div>
        <div id="cmykRgb" class="color-data">RGB: 0, 0, 0</div>
        <div id="cmykValues" class="color-data">CMYK: 0%, 0%, 0%, 100%</div>
      </div>
    </div>

    <h3>Generated Shades</h3>
    <div class="shade-section">
      <div id="shade1" class="shade-box card">
        <div class="color-box"></div>
        <div class="color-data hex">HEX: #000000</div>
        <div class="color-data cmyk">CMYK: 0%, 0%, 0%, 100%</div>
      </div>
      <div id="shade2" class="shade-box card">
        <div class="color-box"></div>
        <div class="color-data hex">HEX: #000000</div>
        <div class="color-data cmyk">CMYK: 0%, 0%, 0%, 100%</div>
      </div>
      <div id="shade3" class="shade-box card">
        <div class="color-box"></div>
        <div class="color-data hex">HEX: #000000</div>
        <div class="color-data cmyk">CMYK: 0%, 0%, 0%, 100%</div>
      </div>
    </div>

    <button id="copyHexBtn" class="btn copy-btn">Copy HEX Values</button>

    <div class="spectrum-container card">
      <div class="spectrum-label">Color Spectrum</div>
      <div id="spectrumBar" class="spectrum-bar"></div>
    </div>
  </div>

  <script>
    // DOM Elements
    const hexInput = document.getElementById('hexInput');
    const errorMessage = document.getElementById('errorMessage');
    const colorPicker = document.getElementById('colorPicker');
    const colorPreview = document.getElementById('colorPreview');
    const resetBtn = document.getElementById('resetBtn');
    const darkModeToggle = document.getElementById('darkModeToggle');
    const cmykModeToggle = document.getElementById('cmykModeToggle');
    const cmykModeLabel = document.getElementById('cmykModeLabel');
    const originalColorBox = document.getElementById('originalColorBox');
    const originalHex = document.getElementById('originalHex');
    const originalRgb = document.getElementById('originalRgb');
    const cmykColorBox = document.getElementById('cmykColorBox');
    const cmykHex = document.getElementById('cmykHex');
    const cmykRgb = document.getElementById('cmykRgb');
    const cmykValues = document.getElementById('cmykValues');
    const shade1 = document.getElementById('shade1');
    const shade2 = document.getElementById('shade2');
    const shade3 = document.getElementById('shade3');
    const copyHexBtn = document.getElementById('copyHexBtn');
    const spectrumBar = document.getElementById('spectrumBar');

    // State variables
    let currentHex = '';
    let isAdditiveMode = false;
  
    // Event Listeners
    hexInput.addEventListener('input', onHexInput);
    colorPicker.addEventListener('input', onColorPick);
    resetBtn.addEventListener('click', resetAll);
    darkModeToggle.addEventListener('change', toggleDarkMode);
    cmykModeToggle.addEventListener('change', toggleCMYKMode);
    copyHexBtn.addEventListener('click', copyHexValues);

    // Initialize with a default color
    colorPicker.value = "#3366CC";
    colorPreview.style.backgroundColor = "#3366CC";
    hexInput.value = "3366CC";
    currentHex = "3366CC";
    generateColors();

    // Functions
    function onHexInput(e) {
      let value = e.target.value.toUpperCase();
      
      // Remove any non-hex characters
      value = value.replace(/[^0-9A-F]/g, '');
      
      // Update the input with cleaned value
      e.target.value = value;
      
      // Validate
      const isValid = /^[0-9A-F]{6}$/.test(value);
      
      if (value.length === 6) {
        if (isValid) {
          errorMessage.textContent = '';
          currentHex = value;
          updateColorPicker(value);
          generateColors();
        } else {
          errorMessage.textContent = 'Please enter valid HEX characters (0-9, A-F)';
        }
      } else if (value.length > 0) {
        errorMessage.textContent = 'Please enter exactly 6 characters';
      } else {
        errorMessage.textContent = '';
      }
    }

    function onColorPick(e) {
      const hexValue = e.target.value.substring(1).toUpperCase();
      hexInput.value = hexValue;
      currentHex = hexValue;
      errorMessage.textContent = '';
      colorPreview.style.backgroundColor = e.target.value;
      generateColors();
    }

    function updateColorPicker(hex) {
      colorPicker.value = `#${hex}`;
      colorPreview.style.backgroundColor = `#${hex}`;
    }

    function generateColors() {
      if (!currentHex) return;
      
      // Convert HEX to RGB
      const rgb = hexToRgb(currentHex);
      if (!rgb) return;
      
      // Update original color section
      originalColorBox.style.backgroundColor = `#${currentHex}`;
      originalHex.textContent = `HEX: #${currentHex}`;
      originalRgb.textContent = `RGB: ${rgb.r}, ${rgb.g}, ${rgb.b}`;
      
      // Convert RGB to CMYK
      const cmyk = rgbToCmyk(rgb);
      
      // Simulate CMYK conversion (with enhancements)
      const simulatedRgb = simulateCmykPrint(rgb);
      const simulatedHex = rgbToHex(simulatedRgb);
      
      // Update CMYK color section
      cmykColorBox.style.backgroundColor = `#${simulatedHex}`;
      cmykHex.textContent = `HEX: #${simulatedHex}`;
      cmykRgb.textContent = `RGB: ${Math.round(simulatedRgb.r)}, ${Math.round(simulatedRgb.g)}, ${Math.round(simulatedRgb.b)}`;
      cmykValues.textContent = `CMYK: ${Math.round(cmyk.c)}%, ${Math.round(cmyk.m)}%, ${Math.round(cmyk.y)}%, ${Math.round(cmyk.k)}%`;
      
      // Generate shades
      generateShades(simulatedRgb, cmyk);
      
      // Update spectrum
      updateSpectrum(simulatedHex);
    }

    function generateShades(simulatedRgb, cmyk) {
      const shades = [];
      
      if (isAdditiveMode) {
        // CMYK Additive Mode
        const shade1Cmyk = {
          c: Math.min(100, cmyk.c + 3),
          m: Math.min(100, cmyk.m + 3),
          y: Math.min(100, cmyk.y + 3),
          k: Math.min(100, cmyk.k + 3)
        };
        
        const shade2Cmyk = {
          c: Math.min(100, cmyk.c + 6),
          m: Math.min(100, cmyk.m + 6),
          y: Math.min(100, cmyk.y + 6),
          k: Math.min(100, cmyk.k + 6)
        };
        
        const shade3Cmyk = {
          c: Math.min(100, cmyk.c + 9),
          m: Math.min(100, cmyk.m + 9),
          y: Math.min(100, cmyk.y + 9),
          k: Math.min(100, cmyk.k + 9)
        };
        
        shades.push({
          rgb: cmykToRgb(shade1Cmyk),
          cmyk: shade1Cmyk
        });
        
        shades.push({
          rgb: cmykToRgb(shade2Cmyk),
          cmyk: shade2Cmyk
        });
        
        shades.push({
          rgb: cmykToRgb(shade3Cmyk),
          cmyk: shade3Cmyk
        });
      } else {
        // Darken Mode
        shades.push({
          rgb: darkenRgb(simulatedRgb, 0.1),
          cmyk: rgbToCmyk(darkenRgb(simulatedRgb, 0.1))
        });
        
        shades.push({
          rgb: darkenRgb(simulatedRgb, 0.15),
          cmyk: rgbToCmyk(darkenRgb(simulatedRgb, 0.15))
        });
        
        shades.push({
          rgb: darkenRgb(simulatedRgb, 0.2),
          cmyk: rgbToCmyk(darkenRgb(simulatedRgb, 0.2))
        });
      }
      
      // Update shade elements
      updateShadeElement(shade1, shades[0]);
      updateShadeElement(shade2, shades[1]);
      updateShadeElement(shade3, shades[2]);
      
      // Update spectrum markers for shades
      updateSpectrumMarkers(simulatedRgb, shades);
    }

    function updateShadeElement(element, shade) {
      const hex = rgbToHex(shade.rgb);
      element.querySelector('.color-box').style.backgroundColor = `#${hex}`;
      element.querySelector('.hex').textContent = `HEX: #${hex}`;
      element.querySelector('.cmyk').textContent = `CMYK: ${Math.round(shade.cmyk.c)}%, ${Math.round(shade.cmyk.m)}%, ${Math.round(shade.cmyk.y)}%, ${Math.round(shade.cmyk.k)}%`;
      element.dataset.hex = hex;
    }

    function updateSpectrum(simulatedHex) {
      // Create gradient from black to color to white
      spectrumBar.style.background = `linear-gradient(to right, #000000, #${simulatedHex}, #FFFFFF)`;
    }

    function updateSpectrumMarkers(simulatedRgb, shades) {
      // Clear existing markers
      while (spectrumBar.firstChild) {
        spectrumBar.removeChild(spectrumBar.firstChild);
      }
      
      // Original color marker
      const originalRgb = hexToRgb(currentHex);
      addSpectrumMarker(originalRgb, 'Original', currentHex, '#' + currentHex);
      
      // Simulated CMYK marker
      const simulatedHex = rgbToHex(simulatedRgb);
      addSpectrumMarker(simulatedRgb, 'CMYK', simulatedHex, '#' + simulatedHex);
      
      // Shade markers
      addSpectrumMarker(shades[0].rgb, 'Shade 1', rgbToHex(shades[0].rgb), '#' + rgbToHex(shades[0].rgb));
      addSpectrumMarker(shades[1].rgb, 'Shade 2', rgbToHex(shades[1].rgb), '#' + rgbToHex(shades[1].rgb));
      addSpectrumMarker(shades[2].rgb, 'Shade 3', rgbToHex(shades[2].rgb), '#' + rgbToHex(shades[2].rgb));
    }

    function addSpectrumMarker(rgb, label, hex, backgroundColor) {
      const brightness = getPerceivedBrightness(rgb);
      const marker = document.createElement('div');
      marker.className = 'spectrum-marker';
      marker.style.left = `${brightness * 100}%`;
      marker.style.backgroundColor = backgroundColor;
      
      const tooltip = document.createElement('div');
      tooltip.className = 'marker-tooltip';
      tooltip.textContent = `${label}: #${hex}`;
      
      marker.appendChild(tooltip);
      spectrumBar.appendChild(marker);
    }

    function getPerceivedBrightness(rgb) {
      // HSP (Highly Sensitive Persons) equation for perceived brightness
      // See: http://alienryderflex.com/hsp.html
      const r = rgb.r / 255;
      const g = rgb.g / 255;
      const b = rgb.b / 255;
      
      return Math.sqrt(
        0.299 * r * r +
        0.587 * g * g +
        0.114 * b * b
      );
    }

    function copyHexValues() {
      if (!shade1.dataset.hex) return;
      
      const hexValues = [
        `• #${shade1.dataset.hex}`,
        `• #${shade2.dataset.hex}`,
        `• #${shade3.dataset.hex}`
      ].join('\n');
      
      navigator.clipboard.writeText(hexValues).then(() => {
        const originalText = copyHexBtn.textContent;
        copyHexBtn.textContent = 'Copied!';
        setTimeout(() => {
          copyHexBtn.textContent = originalText;
        }, 2000);
      });
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
    }

    function toggleCMYKMode() {
      isAdditiveMode = cmykModeToggle.checked;
      if (currentHex) {
        generateColors();
      }
    }

    function resetAll() {
      // Reset to default color
      hexInput.value = '3366CC';
      currentHex = '3366CC';
      errorMessage.textContent = '';
      colorPicker.value = '#3366CC';
      colorPreview.style.backgroundColor = '#3366CC';
      
      // Reset toggles
      cmykModeToggle.checked = false;
      isAdditiveMode = false;
      cmykModeLabel.textContent = 'Darken Mode';
      
      // Generate colors with default
      generateColors();
    }

    // Color conversion utilities
    function hexToRgb(hex) {
      const r = parseInt(hex.substring(0, 2), 16);
      const g = parseInt(hex.substring(2, 4), 16);
      const b = parseInt(hex.substring(4, 6), 16);
      return { r, g, b };
    }

    function rgbToHex(rgb) {
      return [
        Math.round(rgb.r).toString(16).padStart(2, '0'),
        Math.round(rgb.g).toString(16).padStart(2, '0'),
        Math.round(rgb.b).toString(16).padStart(2, '0')
      ].join('').toUpperCase();
    }

    function rgbToCmyk(rgb) {
      // Normalize RGB values
      const r = rgb.r / 255;
      const g = rgb.g / 255;
      const b = rgb.b / 255;
      
      // Find maximum value
      const k = 1 - Math.max(r, g, b);
      
      // Handle black case
      if (k === 1) {
        return { c: 0, m: 0, y: 0, k: 100 };
      }
      
      // Calculate CMY
      const c = (1 - r - k) / (1 - k) * 100;
      const m = (1 - g - k) / (1 - k) * 100;
      const y = (1 - b - k) / (1 - k) * 100;
      
      return { c, m, y, k: k * 100 };
    }

    function cmykToRgb(cmyk) {
      // Normalize CMYK values
      const c = cmyk.c / 100;
      const m = cmyk.m / 100;
      const y = cmyk.y / 100;
      const k = cmyk.k / 100;
      
      // Calculate RGB
      const r = Math.round(255 * (1 - c) * (1 - k));
      const g = Math.round(255 * (1 - m) * (1 - k));
      const b = Math.round(255 * (1 - y) * (1 - k));
      
      return { r, g, b };
    }

    function simulateCmykPrint(rgb) {
      // Convert to CMYK
      const cmyk = rgbToCmyk(rgb);
      
      // Convert back to RGB with enhancements for FOGRA39 simulation
      const enhancedRgb = cmykToRgb(cmyk);
      
      // Apply gamma correction
      const gamma = 1.1;
      let r = Math.pow(enhancedRgb.r / 255, gamma) * 255;
      let g = Math.pow(enhancedRgb.g / 255, gamma) * 255;
      let b = Math.pow(enhancedRgb.b / 255, gamma) * 255;
      
      // Dot gain simulation - slightly darken
      r *= 0.95;
      g *= 0.95;
      b *= 0.95;
      
      // Slight desaturation
      const luminance = 0.299 * r + 0.587 * g + 0.114 * b;
      const desatFactor = 0.15;
      r = r * (1 - desatFactor) + luminance * desatFactor;
      g = g * (1 - desatFactor) + luminance * desatFactor;
      b = b * (1 - desatFactor) + luminance * desatFactor;
      
      // Reduced contrast
      const midpoint = 127.5;
      const contrastFactor = 0.9;
      r = (r - midpoint) * contrastFactor + midpoint;
      g = (g - midpoint) * contrastFactor + midpoint;
      b = (b - midpoint) * contrastFactor + midpoint;
      
      // Clamp values
      r = Math.max(0, Math.min(255, r));
      g = Math.max(0, Math.min(255, g));
      b = Math.max(0, Math.min(255, b));
      
      return { r, g, b };
    }

    function darkenRgb(rgb, factor) {
      return {
        r: Math.max(0, rgb.r * (1 - factor)),
        g: Math.max(0, rgb.g * (1 - factor)),
        b: Math.max(0, rgb.b * (1 - factor))
      };
    }
  </script>
</body>
</html>